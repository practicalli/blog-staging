<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Practicalli: Writing custom snippets for yasnippet</title>
    <link rel="canonical" href="http://practical.li/blog-staging/posts/writing-custom-snippets-for-yasnippets/">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu|Ubuntu+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css">
    <link href="/blog-staging/css/screen.css" rel="stylesheet" type="text/css" />
</head>
<body>


<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/blog-staging/">
              <img src="/blog-staging//images/practicalli-logo-name.png" alt="Practicalli logo" />
            </a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li ><a href="/blog-staging/">Home</a></li>
                <li
                ><a href="/blog-staging/archives/">Archives</a></li>
                
                <li
                >
                <a href="/blog-staging/pages/about/">About</a>
                </li>
                
                <li><a href="/blog-staging/feed.xml">RSS</a></li>
                <li><a href="https://github.com/practicalli/blog-content/projects/1">Feedback</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
</nav>


<div class="container">


    <div class="row">
        <div class="col-lg-9">
            <div id="content">
                
<div id="post">
    <div class="post-header">
    <div id="post-meta" class="row">
        <div class="col-lg-6">July 23, 2016</div>
        
    </div>
    <h2>Writing custom snippets for yasnippet</h2>

    <!-- conditional topic logo displayed if :topic has value in a post -->
    
    <img class="topic" src="/blog-staging/images/emacs-logo-name.png" alt="emacs logo" />
    
</div>
<div>
    
    <p>Snippets are names that expand to code or documentation, to minimise typing commonly used code pattern and can serve as a reminder of common Clojure forms.</p><p>YASnippets uses plain text templates, so are very easy to learn and write.</p><p>Spacemacs has lots of snippets for most of the languages and modes it supports.  However,</p><blockquote><p>Also see a <a href="https://joaotavora.github.io/yasnippet/snippet-development.html">detailed writing snippets guide</a></p></blockquote><p>Lets look at how to add custom snippets with Spacemacs.</p><!-- more --><h2 id="yasnippet-template-metadata">Yasnippet Template metadata</h2><p>Metadata directives have the form <code># property: value</code> and appear before a <code># --</code> line in the snippet file.</p><ul><li><code># key:</code> abbreviation typed to expand a snippet (not be expandable if not specified)</li><li><code># name:</code> one-line description of the snippet, displayed in the completion menu (ideally unique for the Emacs mode). File name used if not specified</li><li><code># uuid:</code> unique identifier for a snippet, independent of its name</li><li><code># contributor:</code> name of the snippet author</li><li><code># condition:</code> expansion condition in Elisp, snippet only expands if condition non-nil</li><li><code># group:</code> group snippets for a given Emacs mode into sub-menus (Yasnippet menu)</li><li><code># expand-env:</code> Elisp varlist to override variable values during snippet expansion</li><li><code># binding:</code> define Emacs keybinding to expand snippet</li><li><code># type:</code> body is <code>snippet</code> (parse text template) or <code>command</code> (interpret Elisp)</li></ul><h2 id="tab-stops">Tab Stops</h2><h2 id="placeholders">Placeholders</h2><p>Snippets benefit from placeholders which can guide the completion of tab stop values by providing a default value.  That value is replaced when entering the tab stop so does not interfere with adding specific values into the expanded snippet.</p><p>A placeholder is defined using <code>{}</code> around the tab stop number and the default value</p><p>Example: deftest</p><pre><code></code></pre><h2 id="ensuring-correct-indentation">Ensuring correct indentation</h2><p><code>$&gt;</code> at the end of a line in the snippet ensures that line is correctly indented, according to the rules of the Emacs mode the snippet is from.</p><h2 id="how-to-write-a-snippet">How to write a snippet</h2><p>Typically each snippet template is contained in its own file, named after the alias of the snippet.  So a snippet called <code>wip</code> will be in a filename wip, in a directory named after the relevant Emacs mode.</p><p>The basic structure of a snippet template is:</p><pre><code># contributor: Practicalli
# key : snippet-name
# name : One-line description of the snippet (shows in completion menu)
# --
Add the content you want to replace the snippet name with when it expands
</code></pre><p>The content can be anything, simple text or more usefully a code strucuture with placeholders for tab stops.  You can even include Emacs lisp (elisp) code in there too.</p><h2 id="example-simple-text-replacement">Example: Simple text replacement</h2><p>I use markdown mode for writing a lot of content, especially for technical workshops.  As I am developing these workshops its useful to highlight which sections are still work in progress.  Rather than type the common message I use, I've created a simple snippet called <code>wip</code>.</p><pre><code># contributor: Practicalli
# key : hint-wip
# name : Hint callout work in progress
# --
&gt; #### TODO::Work in progress
</code></pre><p>When you expand this snippet with <code>M-/</code> then the snippet name is replaced by the content.</p><h2 id="example-using-tab-stops">Example: Using tab stops</h2><p>An HTML form expressed in Clojure hiccup syntax has a standard structure with multiple custom values.  Adding tab stops within the snippet structure makes the form values simple to complete.</p><pre><code># contributor : Practicalli
# key : hiccup-form
# name : [:form {:method "..." :id "..." :action "..."}]
# --
[:form {:method "$1"$&gt;
        :id "$2"$&gt;
        :action "$3"}$&gt;
$0
</code></pre><p>This snippet is the same as the simpler example, except we have added <strong>tab stops</strong> using the <code>$</code> sign and a number.  When you expand this snippet, the snippet name is replaced by the content as usual but the cursor is placed at the first tab stop <code>$1</code>.  Each time you press <code>TAB</code> you move to the next tab stop.</p><p><code>$0</code> is our exit point from the snippet, so pressing <code>TAB</code> reverts to the usual behaviour outside of YASnippet.</p><h2 id="creating-a-snippet-from-a-region">Creating a snippet from a region</h2><p>A quick way to create a snippet is to select a region of text that is a specific instance of what the snippet would be used to create.</p><p><code>v</code> and motion keys to select the relevant region of text</p><p><code>SPC SPC helm-yas-create-snippet-on-region</code> to start creating a snippet from that selected region</p><p>Enter a file name in the respective Emacs mode for the snippet, defaulting to the current mode.</p><p>A new file is created with the following metadata directives</p><pre><code class="none"># -*- mode: snippet -*-
#name : delete-me
#key : delete-me
#contributor : Practicalli
# --
The region of text that was selected.  Edit me to make the desired snippet.
</code></pre><p>Edit the body of your snippet to replace the specific names and values with tab stop placeholders, <code>$1</code> <code>$2</code>, <code>$3</code>, etc.</p><p><code>C-c C-c</code> to save the snippet buffer and load the snippet into the respective Emacs mode, making it immediately available.</p><h2 id="update-an-existing-snippet">Update an existing snippet</h2><p><code>SPC SPC helm-yas-visit-snippet-file</code> opens a helm popup</p><h2 id="example-create-a-simple-text-replacement">Example: Create a simple text replacement</h2><p>When I write blogs I include a image thumbnail that gives a visual clue as to the topic of the article.  Rather than type this in I created a snippet.</p><p>First I mark the text I want my new snippet to expand too, in this example: ** {% raw %} {% img img-thumbnail /images/spacemacs.png %} {% endraw %} **.</p><p>Then I call the function <code>helm-yas-create-snippet-on-region</code>.  This prompts me for the mode for the snippet, in this case markdown-mode, then prompts for the location for the snippet file, <code>~/.emacs/private/snippets/markdown-mode/imgtmb-spacemacs</code>.  A new buffer is created with my snippet already filled in.</p><pre><code># -*- mode: snippet -*-
#name : imgtmb-spacemacs
#key : imgtmb-spacemacs
#contributor : jr0cket
# --
{% img img-thumbnail /images/spacemacs.png %}

</code></pre><p>The new snippet buffer already has the name and key values populated from the filename I gave for the snippet, <code>imgtmb-spacemacs</code>.  The snippet body is also populated automatically from the text I had highlighted.  So all I need to do is save the new snippet and try it out.</p><h2 id="testing-your-snippets">Testing your snippets</h2><p>Once you have written your snippet, you can quickly test it using <code>M-x yas-tryout-snippet</code>.  This opens a new empty buffer in the appropriate major mode and inserts the snippet so you can then test it with <code>M-/</code>.</p><p>If you just want to try the snippet in an existing buffer, then use <code>M-x yas-load-snippet-buffer</code> to load this new snippet into the correct mode.  <code>M-x yas-load-snippet-buffer</code> does exactly the same except it kills the snippet buffer (prompting to save first if neccessary).</p><blockquote><p>There are no default keybindings for these commands in Spacemacs, so you could create a binding under <code>C-o</code>, for example <code>C-o C-s t</code> to try a snippet and <code>C-o C-s l</code> to load a snippet.</p></blockquote><h2 id="spacemacs-private-snippets">Spacemacs private snippets</h2><p>The easiest place to add your own snippet definitions is in the <code>~/.emacs.d/private/snippets</code> directory.  Under this directory structure you should create a folder named after the relevant mode for your snippets, eg <code>markdown-mode</code>.  Inside this mode folder, create files whos names are based on the snippet alias you wish.</p><p>So for a work in progress snipped called <code>wip</code> in markdown mode I created <code>~/.emacs.d/private/snippets/markdown-mode/wip</code> file.</p><p>You need to load this new snippet into Spacemacs by either restarting or using the command <code>M-x yas-load-snippet-buffer</code> command in the buffer of the new snippet you have just written.  Ths snippet with then work within any markdown mode buffer.</p><h2 id="managing-your-snippets">Managing your snippets</h2><p>Although the private snippets directory is easy to use, it is not under version control.  So although its not over-riddend by Spacemacs it also means your private snippets are not backed up anywhere.</p><p>If you use the <code>~/.spacemacs.d/snippets/modename-mode/</code> directory structure for your snippets then you can version them with Git or similar versioning tools.</p><h2 id="summary">Summary</h2><p>Find out more about YASnippets and autocompletion from the <a href="https://github.com/syl20bnr/spacemacs/tree/master/layers/auto-completion">Github repository for Spacemacs autocompletion layer</a>.</p><p>For more details and examples on writing your own snipplets, take a look at:</p><ul><li><a href="https://www.youtube.com/watch?v=-4O-ZYjQxks">Emacs YASnippet video tutorial</a></li><li><a href="https://joaotavora.github.io/yasnippet/snippet-development.html">Snippet development</a>.</li><li><a href="http://jotham-city.com/blog/2015/03/21/adding-yasnippets-snippets/">Adding YASnippets snippets</a></li><li><a href="http://cupfullofcode.com/blog/2013/02/26/snippet-expansion-with-yasnippet/index.html">Snippet expansion with YASnippet</a></li></ul><blockquote><p>Article originally published on <a href="https://jr0cket.co.uk/">jr0cket.co.uk</a> and has been migrated to <a href="https://practical.li/blog/">practical.li/blog</a></p></blockquote><p>Thank you.
<a href="https://github.com/practicalli">practicalli GitHub profile</a> I <a href="https://twitter.com/practcial_li">@practical_li</a></p>
</div>

<div id="post-tags">
    <b>Tags: </b>
    
    <a href="/blog-staging/tags/emacs/">emacs</a>
    
    <a href="/blog-staging/tags/snippets/">snippets</a>
    
    <a href="/blog-staging/tags/spacemacs/">spacemacs</a>
    
</div>


    <div id="prev-next">
        
        <a href="/blog-staging/posts/yasnippets-for-faster-clojure-development/">&laquo; YASnippets for faster clojure coding</a>
        
        
        <a class="right" href="/blog-staging/posts/2016-01-07-docs/">Quick Start Guide &raquo;</a>
        
    </div>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = "http://practical.li/blog-staging/posts/writing-custom-snippets-for-yasnippets/";
            this.page.identifier = "Writing custom snippets for yasnippet";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//practicalli-blog.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    


</div>

            </div>
        </div>

        <div class="col-md-3">
            <div id="sidebar">
                <h3>Links</h3>
                <ul id="links">
                    <li><a href="http://practical.li/">Practicalli Home</a></li>
                    <li><a href="http://yt.vu/+practicalli">YouTube channel</a></li>
                    <li><a href="https://github.com/practicalli/blog-content/projects/1">Feeback / Issues</a></li>
                    
                    <li><a href="/blog-staging/pages/contributing/">Contributing</a></li>
                    
                </ul>
                
                <div id="recent">
                    <h3>Recent Posts</h3>
                    <ul>
                        
                        <li><a href="/blog-staging/posts/emacs-cider-removing-old-cider-compat/">Emacs CIDER removing old cider-compat namespace</a></li>
                        
                        <li><a href="/blog-staging/posts/clojure-which-execution-option-to-use/">Clojure CLI tools - which execution option to use</a></li>
                        
                        <li><a href="/blog-staging/posts/clojure-cli-tools-understanding-aliases/">Clojure CLI tools - understanding aliases</a></li>
                        
                        <li><a href="/blog-staging/posts/automate-cryogen-clojure-blog-with-github-actions/">Automate Cryogen Clojure blog with GitHub Actions</a></li>
                        
                        <li><a href="/blog-staging/posts/overview-of-language-server-protocol-lsp-for-clojure-development/">Overview of Language Server Protocol LSP for Clojure development</a></li>
                        
                        <li><a href="/blog-staging/posts/brave-clojure-redux-part01-the-repl/">Brave Clojure redux - part 1 - the REPL</a></li>
                        
                        <li><a href="/blog-staging/posts/clojure-repl-jack-in-or-connect/">Clojure CLI tools - To jack-in or connect, that is the question</a></li>
                        
                        <li><a href="/blog-staging/posts/clojure-cli-aliases-deserve-designing-too/">Clojure CLI tools aliases deserve good design too</a></li>
                        
                        <li><a href="/blog-staging/posts/cloure-community-getting-help/">Clojure community - getting help</a></li>
                        
                    </ul>
                </div>
                
                
                <div id="tags">
                    <h3>Tags</h3>
                    <ul>
                        
                        <li><a href="/blog-staging/tags/json/">json</a></li>
                        
                        <li><a href="/blog-staging/tags/ring/">ring</a></li>
                        
                        <li><a href="/blog-staging/tags/very%20fetch/">very fetch</a></li>
                        
                        <li><a href="/blog-staging/tags/ubuntu/">ubuntu</a></li>
                        
                        <li><a href="/blog-staging/tags/lsp/">lsp</a></li>
                        
                        <li><a href="/blog-staging/tags/cryogen/">cryogen</a></li>
                        
                        <li><a href="/blog-staging/tags/aliases/">aliases</a></li>
                        
                        <li><a href="/blog-staging/tags/challenges/">challenges</a></li>
                        
                        <li><a href="/blog-staging/tags/github/">github</a></li>
                        
                        <li><a href="/blog-staging/tags/clojure/">clojure</a></li>
                        
                        <li><a href="/blog-staging/tags/httpkit/">httpkit</a></li>
                        
                        <li><a href="/blog-staging/tags/webapps/">webapps</a></li>
                        
                        <li><a href="/blog-staging/tags/clojure-cli/">clojure-cli</a></li>
                        
                        <li><a href="/blog-staging/tags/pull-requests/">pull-requests</a></li>
                        
                        <li><a href="/blog-staging/tags/editors/">editors</a></li>
                        
                        <li><a href="/blog-staging/tags/tools-deps/">tools-deps</a></li>
                        
                        <li><a href="/blog-staging/tags/hardware/">hardware</a></li>
                        
                        <li><a href="/blog-staging/tags/cider/">cider</a></li>
                        
                        <li><a href="/blog-staging/tags/emacs/">emacs</a></li>
                        
                        <li><a href="/blog-staging/tags/clj-http/">clj-http</a></li>
                        
                        <li><a href="/blog-staging/tags/calva/">calva</a></li>
                        
                        <li><a href="/blog-staging/tags/snippets/">snippets</a></li>
                        
                        <li><a href="/blog-staging/tags/thinkpad/">thinkpad</a></li>
                        
                        <li><a href="/blog-staging/tags/events/">events</a></li>
                        
                        <li><a href="/blog-staging/tags/community/">community</a></li>
                        
                        <li><a href="/blog-staging/tags/advent-of-parens/">advent-of-parens</a></li>
                        
                        <li><a href="/blog-staging/tags/spacemacs/">spacemacs</a></li>
                        
                        <li><a href="/blog-staging/tags/help/">help</a></li>
                        
                        <li><a href="/blog-staging/tags/lenovo/">lenovo</a></li>
                        
                        <li><a href="/blog-staging/tags/compojure/">compojure</a></li>
                        
                        <li><a href="/blog-staging/tags/klipse/">klipse</a></li>
                        
                        <li><a href="/blog-staging/tags/figwheel-main/">figwheel-main</a></li>
                        
                        <li><a href="/blog-staging/tags/not%20fetch/">not fetch</a></li>
                        
                        <li><a href="/blog-staging/tags/web-scraper/">web-scraper</a></li>
                        
                        <li><a href="/blog-staging/tags/blogging/">blogging</a></li>
                        
                        <li><a href="/blog-staging/tags/conjure/">conjure</a></li>
                        
                        <li><a href="/blog-staging/tags/github-actions/">github-actions</a></li>
                        
                        <li><a href="/blog-staging/tags/apis/">apis</a></li>
                        
                        <li><a href="/blog-staging/tags/static-sites/">static-sites</a></li>
                        
                        <li><a href="/blog-staging/tags/re-clojure/">re-clojure</a></li>
                        
                        <li><a href="/blog-staging/tags/packages/">packages</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
    </div>
    <footer>
      Copyright &copy; 2022 Practicalli
      <p style="text-align: center;">Powered by <a href="http://cryogenweb.org">Cryogen</a></p>

      <license id="license">
        <div>
          <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution 4.0 ShareAlike License</a>, including custom images & stylesheets.</p>
          <p>Permissions beyond the scope of this license may be available by contacting <a xmlns:cc="http://creativecommons.org/ns#" href="https://twitter.com/practical_li" rel="cc:morePermissions">@practical_li</a></p>
          <br>
          <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
        </div>
      </license>

    </footer>
</div>
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="/blog-staging/js/highlight.pack.js" type="application/javascript"></script>
<script>hljs.initHighlightingOnLoad();</script>


</body>
</html>
